# Nexus Configuration File - Permissions Rules

# Deny all users from running rm command
# deny * cmd *rm

# Allow user1 to run apt as root with arguments for installing packages
# allow user1 as root cmd /usr/bin/apt args install priority 10 role admin

# Allow user2 to run apt as root without arguments
# allow user2 as root cmd /usr/bin/apt priority 5 role user

# Allow user3 to run ls as any user, but only on 'server1'
# allow user3 cmd /usr/bin/ls host server1 priority 8 role guest

# Allow user4 to run apt as root only with the admin role
# allow user4 as root cmd /usr/bin/apt priority 3 role admin

# Allow user5 to run any command only with the user role
# allow user5 cmd /usr/bin/* priority 2 role user

# Allow user6 to run ls command matching a specific regex
# allow user6 cmd /usr/bin/ls cmd_regex "ls -d.*" priority 7 role guest

# Allow role 'admin' to run administrative commands without restriction
# allow admin cmd /usr/bin/apt
# allow admin cmd /usr/bin/systemctl

# Set timeout between requiring password (default: 15 minutes)
timeout 900

# Require password for all users
password_required true

# Allow everyone to run basic commands without escalation
allow * cmd /usr/bin/ls
allow * cmd /usr/bin/cat
allow * cmd /usr/bin/echo

# Wheel group can run any command
allow :wheel cmd *
